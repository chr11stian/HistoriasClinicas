<div #drop></div>
<div #date></div>

<p-toolbar>
    <ng-template pTemplate="left">
        <h3 class="mt-2">RESULTADOS DE LABORATORIO Y ECOGRAFIA</h3>
    </ng-template>
    <ng-template pTemplate="right" class="button">
        <button class="button-agregar" icon="pi pi-save" pButton type="button" label="Guardar"
            (click)="guardarTodosDatos()"></button>
    </ng-template>
</p-toolbar>


<div class="grid m-3">
    <div class="col-3">
        <form [formGroup]="form">
            <p-fieldset legend="PROXIMA CITA">
                <div class="grid ">
                    <div class="col-12">
                        <p-calendar [ngModel]="fecha" [showIcon]="true" dateFormat="yy-mm-dd" formControlName="proxCita" inputId="icon">
                        </p-calendar>
                    </div>
                    <div class="col-12">
                        <p-button label="Ver cronograma citas" icon="pi pi-calendar-plus" (click)="openCalendar()">
                        </p-button>
                    </div>
                </div>
            </p-fieldset>
            <br/>
            <p-fieldset legend="RESPONSABLE ATENCIÓN">
                <div class="grid p-fluid">
                    <div class="col-12">
                        <label>Nombre:</label>
                        <br/>
                        <input type="text" pInputText formControlName='nombreResponsable' placeholder="Responsable"
                            style="text-transform:uppercase" />
                    </div>
                    <div class="col-12">
                        <label>Nro doc:</label>
                        <br/>
                        <input type="text" pInputText formControlName='docResponsable' placeholder="Responsable"
                            style="text-transform:uppercase" />
                    </div>
                </div>
            </p-fieldset>
        </form>
    </div>
    <br />
    <div class="col-9">
        <div class="grid">
            <div class="col-12">
                <p-toolbar>
                    <ng-template pTemplate="left">
                        <h3 class="p-m-0">INTERCONSULTAS</h3>
                    </ng-template>
                </p-toolbar>
                <p-table class="table-over" [value]="interconsultas" #dt styleClass="p-datatable-gridlines" [rows]="10"
                    [rowsPerPageOptions]="[10, 25, 50]" [paginator]="true" [autoLayout]="true"
                    [showCurrentPageReport]="true"
                    currentPageReportTemplate="Mostrando {first} de {last} de {totalRecords} entradas">

                    <ng-template pTemplate="header" styleClass="p-datatable-gridlines">
                        <tr>
                            <th style="text-align: center" class="font-2">Nro </th>
                            <th style="text-align: center" class="font-1">SERVICIO</th>
                            <th style="text-align: center" class="font-2">MOTIVO</th>
                            <th style="text-align: center" class="font-2">FECHA</th>
                            <th style="text-align: center" class="font-2">NIVEL URGENCIA</th>
                            <th style="text-align: center" class="font-2">ACCIONES</th>

                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex">
                        <tr>
                            <td style="text-align: center" class="font-2">{{ rowIndex + 1 }}</td>
                            <td style="text-align: center">{{ rowData.servicio }}</td>
                            <td style="text-align: center">{{ rowData.motivo }}</td>
                            <td style="text-align: center">{{ rowData.fecha }}</td>
                            <td style="text-align: center">{{ rowData.nivelUrgencia }}</td>
                            <td style="text-align: center">
                                <button pButton pRipple icon="pi pi-pencil"
                                    class="p-button-rounded p-button-primary m-1"
                                    (click)="openDialogEditarinterconsultas(rowData,rowIndex)" pTooltip="Editar">
                                </button>
                                <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger m-1"
                                    (click)="eliminarInterconsulta(rowIndex)" pTooltip="Eliminar">
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
                <p-toolbar>
                    <div class="p-toolbar-group-right">
                        <button pButton pRipple label="Agregar Interconsulta" icon="pi pi-plus" pButton type="button"
                            class="button-agregar" (click)="openDialogInterconsultas()"></button>
                    </div>
                </p-toolbar>
            </div>
        </div>
    </div>
</div>

<!-- dialogo para cronograma citas -->

<p-dialog [(visible)]="cronogramaDialog" [style]="{width: '580px',heigth:'400px'}" [modal]="true">
    <ng-template pTemplate="header">
        <h3>CRONOGRAMA DE CITAS DE LA GESTANTE</h3>
    </ng-template>
    <ng-template pTemplate="body">
        <div class="grid" class="m-3">
            <p-table [value]="cronograma">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="text-align: center">Nro</th>
                        <th style="text-align: center">Descripción</th>
                        <th style="text-align: center">Tipo</th>
                        <th style="text-align: center">Fecha</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-data let-rowIndex="rowIndex">
                    <tr [ngClass]="{'row-faltantes': funcionAuxiliar(data.fecha) > hoy}">
                        <td style="text-align: center">{{ rowIndex + 1 }}</td>
                        <td style="text-align: center">{{ data.descripcion }}</td>
                        <td style="text-align: center">{{ data.tipo }}</td>
                        <td style="text-align: center">{{ data.fecha }}</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </ng-template>
    <ng-template pTemplate="footer">
        <button pButton type="button" label="Salir" class="p-button-danger" (click)="salirCronograma()"></button>
    </ng-template>
</p-dialog>